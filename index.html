<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Discipline Tracker</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100 text-gray-800 font-sans">
  <div class="max-w-3xl mx-auto p-4">
    <h1 class="text-3xl font-bold mb-4">üõ°Ô∏è Discipline Tracker</h1>
    <p class="mb-6">Track your progress. Stay accountable. Build your best self.</p>

    <!-- Daily Check-in -->
    <div class="bg-white shadow rounded-lg p-4 mb-4">
      <h2 class="text-xl font-semibold mb-2">Today's Check-in</h2>
      <form id="checkin-form" class="space-y-2">
        <div>
          <label class="inline-flex items-center">
            <input type="checkbox" class="form-checkbox" name="porn">
            <span class="ml-2">Stayed away from Porn</span>
          </label>
        </div>
        <div>
          <label class="inline-flex items-center">
            <input type="checkbox" class="form-checkbox" name="masturbation">
            <span class="ml-2">Stayed away from Masturbation</span>
          </label>
        </div>
        <div>
          <label class="inline-flex items-center">
            <input type="checkbox" class="form-checkbox" name="betting">
            <span class="ml-2">Avoided Betting</span>
          </label>
        </div>
        <div>
          <label class="inline-flex items-center">
            <input type="checkbox" class="form-checkbox" name="meaningful">
            <span class="ml-2">Did Something Meaningful</span>
          </label>
        </div>
        <button type="submit" class="mt-4 bg-blue-500 text-white px-4 py-2 rounded">Save Check-in</button>
      </form>
    </div>

    <!-- Temptation Log -->
    <div class="bg-white shadow rounded-lg p-4 mb-4">
      <h2 class="text-xl font-semibold mb-2">Temptation Log</h2>
      <form id="temptation-form" class="space-y-2">
        <input type="text" id="temptation-trigger" class="w-full p-2 border rounded" placeholder="Trigger (e.g. boredom)">
        <input type="text" id="temptation-action" class="w-full p-2 border rounded" placeholder="What you did to resist or not">
        <select id="temptation-outcome" class="w-full p-2 border rounded">
          <option value="">Select Outcome</option>
          <option value="overcame">‚úÖ Overcame</option>
          <option value="failed">‚ùå Gave In</option>
        </select>
        <button type="submit" class="bg-green-500 text-white px-4 py-2 rounded">Save Log</button>
      </form>
    </div>

    <!-- Daily Win -->
    <div class="bg-white shadow rounded-lg p-4 mb-4">
      <h2 class="text-xl font-semibold mb-2">Today's Win</h2>
      <textarea id="daily-win" class="w-full p-2 border rounded" rows="3" placeholder="Something good or meaningful you did today..."></textarea>
      <button id="save-win" class="mt-2 bg-purple-500 text-white px-4 py-2 rounded">Save</button>
    </div>

    <!-- Streak Display -->
    <div class="bg-white shadow rounded-lg p-4 mb-4">
      <h2 class="text-xl font-semibold mb-2">üî• Streaks</h2>
      <div id="streaks-output" class="text-sm space-y-1"></div>
    </div>

    <!-- Placeholder for output -->
    <div id="output" class="bg-white shadow rounded-lg p-4 mt-6 text-sm"></div>
  </div>

  <script>
    const checkinForm = document.getElementById('checkin-form');
    const temptationForm = document.getElementById('temptation-form');
    const output = document.getElementById('output');
    const winButton = document.getElementById('save-win');
    const streaksOutput = document.getElementById('streaks-output');

    checkinForm.addEventListener('submit', e => {
      e.preventDefault();
      const formData = new FormData(checkinForm);
      const data = {};
      formData.forEach((value, key) => {
        data[key] = true;
      });
      const date = new Date().toISOString().split('T')[0];
      localStorage.setItem(`checkin-${date}`, JSON.stringify(data));
      output.innerText = `‚úÖ Check-in saved for ${date}`;
      updateStreaks();
    });

    temptationForm.addEventListener('submit', e => {
      e.preventDefault();
      const trigger = document.getElementById('temptation-trigger').value;
      const action = document.getElementById('temptation-action').value;
      const outcome = document.getElementById('temptation-outcome').value;
      const date = new Date().toISOString();

      const log = { date, trigger, action, outcome };
      const logs = JSON.parse(localStorage.getItem('temptation-logs') || '[]');
      logs.push(log);
      localStorage.setItem('temptation-logs', JSON.stringify(logs));

      output.innerText = `üìù Temptation log saved.`;
      temptationForm.reset();
    });

    winButton.addEventListener('click', () => {
      const win = document.getElementById('daily-win').value;
      const date = new Date().toISOString().split('T')[0];
      localStorage.setItem(`win-${date}`, win);
      output.innerText = `üèÜ Daily win saved.`;
    });

    function updateStreaks() {
      const keys = Object.keys(localStorage).filter(k => k.startsWith('checkin-')).sort().reverse();
      const categories = ['porn', 'masturbation', 'betting', 'meaningful'];
      const streaks = {};

      for (let cat of categories) {
        streaks[cat] = 0;
        for (let key of keys) {
          const data = JSON.parse(localStorage.getItem(key));
          if (data && data[cat]) {
            streaks[cat]++;
          } else {
            break;
          }
        }
      }

      let html = '';
      for (let cat of categories) {
        html += `<div><strong>${cat}:</strong> üî• ${streaks[cat]} days</div>`;
      }
      streaksOutput.innerHTML = html;
    }

    // Initialize streaks on load
    updateStreaks();
  </script>
</body>
</html>
